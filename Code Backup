map =
"                                                                                \n"+
"                                                                                \n"+
"                                                                                \n"+
"                                                                                \n"+
"                                                                                \n"+
"     999    9999999    999                            999    9999999    999     \n"+
"     99   999     999   99                            99   999     999   99     \n"+
"     9 9 99         99 9 9                            9 9 99         99 9 9     \n"+
"        99           99                                  99           99        \n"+
"       99             99                                99             99       \n"+
"      99               99                              99               99      \n"+
"      9                 9                              9                 9      \n"+
"     99                 99                            99                 99     \n"+
"     9                   9                            9                   9     \n"+
"     9                   9                            9                   9     \n"+
"     9                   9                            9                   9     \n"+
"     9                   9                            9                   9     \n"+
"     9                   9                            9                   9     \n"+
"     99                 99                            99                 99     \n"+
"      9                 9                              9                 9      \n"+
"      99               99                              99               99      \n"+
"       99             99                                99             99       \n"+
"        99           99                                  99           99        \n"+
"     9 9 99         99 9 9                            9 9 99         99 9 9     \n"+
"     99   999     999   99                            99   999     999   99     \n"+
"     999    9999999    999                            999    9999999    999     \n"+
"                                                                                \n"+
"                                                                                \n"+
"                                                                                \n"+
"                                                                                \n"+
"                                                                                \n"+
"                                                                                \n"+
"                                                                                \n"+
"                                 9999      9999                                 \n"+
"                                 9  999  999  9                                 \n"+
"                                 9    9  9    9                                 \n"+
"                                 99   9999   99                                 \n"+
"                                  9          9                                  \n"+
"                                  999      999                                  \n"+
"                                                                                \n"+
"                                                                                \n"+
"                                  999      999                                  \n"+
"                                  9          9                                  \n"+
"                                 99   9999   99                                 \n"+
"                                 9    9  9    9                                 \n"+
"                                 9  999  999  9                                 \n"+
"                                 9999      9999                                 \n"+
"                                                                                \n"+
"                                                                                \n"+
"                                                                                \n"+
"                                                                                \n"+
"                                                                                \n"+
"                                                                                \n"+
"                                                                                \n"+
"     999    9999999    999                            999    9999999    999     \n"+
"     99   999     999   99                            99   999     999   99     \n"+
"     9 9 99         99 9 9                            9 9 99         99 9 9     \n"+
"        99           99                                  99           99        \n"+
"       99             99                                99             99       \n"+
"      99               99                              99               99      \n"+
"      9                 9                              9                 9      \n"+
"     99                 99                            99                 99     \n"+
"     9                   9                            9                   9     \n"+
"     9                   9                            9                   9     \n"+
"     9                   9                            9                   9     \n"+
"     9                   9                            9                   9     \n"+
"     9                   9                            9                   9     \n"+
"     99                 99                            99                 99     \n"+
"      9                 9                              9                 9      \n"+
"      99               99                              99               99      \n"+
"       99             99                                99             99       \n"+
"        99           99                                  99           99        \n"+
"     9 9 99         99 9 9                            9 9 99         99 9 9     \n"+
"     99   999     999   99                            99   999     999   99     \n"+
"     999    9999999    999                            999    9999999    999     \n"+
"                                                                                \n"+
"                                                                                \n"+
"                                                                                \n"+
"                                                                                \n"+
"                                                                                ";

const VOCABULARY = [
    // 1
    {text: "You",       icon: "\u004e", key: "O"},
    {text: "Me",        icon: "\u004f", key: "E"},
    {text: "Hmm",       icon: "\u004b", key: "Q"},
    {text: "Yes",       icon: "\u004c", key: "Y"},
    // 2
    {text: "No",        icon: "\u004d", key: "N"},
    {text: "Hello",     icon: "\u0045", key: "H"},
    {text: "Sorry",     icon: "\u00a1", key: "S"},
    {text: "Attack",    icon: "\u0049", key: "A"},
    // 3
    {text: "Follow Me", icon: "\u0050", key: "F"},
    {text: "Good Game", icon: "\u00a3", key: "G"},
    {text: "Kill",      icon: "\u007f", key: "K"},
    {text: "High Score",icon: "\u002e", key: "K"},
    // 4
    //{text: "Wait",      icon: "\u0048", key: "T"},
    // 5
    {text: "",   icon: "\u{1D7CF}", key: "1"},
    {text: "",   icon: "\u{1D7D0}", key: "2"},
    {text: "",   icon: "\u{1D7D1}", key: "3"},
    {text: "",   icon: "\u{1D7D2}", key: "4"},
    // 6
    {text: "",   icon: "\u{1D7D3}", key: "5"},
    {text: "",   icon: "\u{1D7D4}", key: "6"},
    {text: "",   icon: "\u{1D7D5}", key: "7"},
    {text: "",   icon: "\u{1D7D6}", key: "8"},
    // 7
    {text: "",   icon: "\u{1D7D7}", key: "9"},
    {text: "",   icon: "\u{1D7CE}", key: "0"}
];
//Button data
var Regen_button = {
  id: "Regen",
  position: [76, 1, 3.5, 5.5],
  clickable: true,
  shortcut: "R",
  visible: true,
  components: [
    { type:"box",position:[0,0,100,100],fill:"#456",stroke:"#CDE",width:2},
    { type: "text",position:[10,35,80,30],value:"Regen",color:"#CDE"},
    { type: "text",position:[20,70,60,20],value:"[R]",color:"#CDE"}
    ]
};

var A_Speed_button = {
  id: "A_Speed",
  position: [72, 1, 3.5, 5.5],
  clickable: true,
  shortcut: "T",
  visible: true,
  components: [
    { type:"box",position:[0,0,100,100],fill:"#456",stroke:"#CDE",width:2},
    { type: "text",position:[10,35,80,30],value:"A-Speed",color:"#CDE"},
    { type: "text",position:[20,70,60,20],value:"[T]",color:"#CDE"}
    ]
};

var Return_button = {
  id: "Return",
  position: [68, 1, 3.5, 5.5],
  clickable: true,
  shortcut: "W",
  visible: true,
  components: [
    { type:"box",position:[0,0,100,100],fill:"#456",stroke:"#CDE",width:2},
    { type: "text",position:[10,35,80,30],value:"Return",color:"#CDE"},
    { type: "text",position:[20,70,60,20],value:"[W]",color:"#CDE"}
    ]
};
//button functions
var Regen = function(ship) {
  ship.set({stats:88888888, crystals:719, shield: 1000});
} ;

var A_Speed = function(ship) {
  ship.set({type:605, stats:88888888, crystals:719, shield: 1000});
};

var Return = function(ship) {
  ship.set({x:0,y:0,vx:0,vy:0});
};
//custom functions
var shipCount = function() {
  area1=0;
  area2=0;
  area3=0;
  area4=0;
  a3ship=-1;
  a4ship=-1;
  for (var i=0;i<game.ships.length;i++)
  {
    if (((((game.ships[i].x-250)*(game.ships[i].x-250))+((game.ships[i].y+250)*(game.ships[i].y+250))))<=10000)
    {
      area4=area4+1;
      a4ship=i;
      startTime4=game.step;
    }
    if (((((game.ships[i].x+250)*(game.ships[i].x+250))+((game.ships[i].y+250)*(game.ships[i].y+250))))<=10000)
    {
      area3=area3+1;
      a3ship=i;
      startTime3=game.step;
    }
    if (((((game.ships[i].x-250)*(game.ships[i].x-250))+((game.ships[i].y-250)*(game.ships[i].y-250))))<=10000)
    {
      area2=area2+1;
    }
    if (((((game.ships[i].x+250)*(game.ships[i].x+250))+((game.ships[i].y-250)*(game.ships[i].y-250))))<=10000)
    {
      area1=area1+1;
    }
  }
  if (area1>1)
  {
    
  }
};

//objects
var redX = {
  id: "redX",
  obj: "https://raw.githubusercontent.com/Eman-Bman/starblast-aim-training/refs/heads/main/redX.obj",
  emissiveColor: 0xFF0000
};

var greenY = {
  id: "greenY",
  obj: "https://raw.githubusercontent.com/Eman-Bman/starblast-aim-training/refs/heads/main/greenY.obj",
  emissiveColor: 0x00FF00
};
  
var entry = {
  id: "entry",
  obj: "https://raw.githubusercontent.com/Eman-Bman/starblast-aim-training/refs/heads/main/entry.obj",
  emissiveColor: 0xF0F0FF
};

var center = {
  id: "center",
  obj: "https://raw.githubusercontent.com/Eman-Bman/starblast-aim-training/refs/heads/main/Center_Base.obj",
  emissiveColor: 0xF0F0FF
};


this.options = {
  soundtrack: "argon.mp3",
  root_mode: "",
  map_name: "Aim Training Test",
  custom_map: map,
  vocabulary: VOCABULARY,
  lives: 5,
  radar_zoom: 1,
  weapons_store: false,
  asteroids_strength: 2000,
  map_size: 80
};

this.tick = function(game) {
  //intitalize vars
  if (game.step==1)
  {
    let area1=0;
    let area2=0;
    let area3=0;
    let area4=0;
    let a3ship=-1;
    let a4ship=-1;
  }
  //set initial objects
  if (game.step==60)
  {
    game.setObject({
    id: "center",
    type: center,
    position: {x:0,y:0,z:0},
    rotation: {x:0,y:0,z:0},
    scale: {x:1,y:1,z:1}
    }) ;
    
    game.setObject({
    id: "RedX",
    type: RedX,
    position: {x:0,y:0,z:0},
    rotation: {x:0,y:0,z:0},
    scale: {x:1,y:1,z:1}
    }) ;
  }
  if (game.step%120===0)
  {
    shipCount();
    for (var i=0;i<game.ships.length;i++)
    {
      var ship = game.ships[i] ;
      //install buttons
      if (!ship.custom.Regen_button_installed)
      {
        ship.custom.Regen_button_installed = true;
        ship.setUIComponent(Regen_button);
      }
      if (!ship.custom.A_Speed_button_installed)
      {
        ship.custom.A_Speed_button_installed = true;
        ship.setUIComponent(A_Speed_button);
      }
      if (!ship.custom.Return_button_installed)
      {
        ship.custom.Return_button_installed = true;
        ship.setUIComponent(Return_button);
      }
      //move from lobby to outside
      if (((((game.ships[i].x-50)*(game.ships[i].x-50))+((game.ships[i].y-50)*(game.ships[i].y-50))))<=100)
      {
        //area2
        game.ships[i].set({x:250,y:250,invulnerable:300});
        game.aliens[0].set({rate:1,regen:0,shield:1020,damage:84,laser_speed:205});
      }
      if (((((game.ships[i].x+50)*(game.ships[i].x+50))+((game.ships[i].y+50)*(game.ships[i].y+50))))<=100)
      {
        //area 3
        if (area3===0)
        game.ships[i].set({x:-250,y:-250,invulnerable:300,score:0});
      }
      if (((((game.ships[i].x+50)*(game.ships[i].x+50))+((game.ships[i].y-50)*(game.ships[i].y-50))))<=100)
      {
        //area1
        if (area1<=1)
        game.ships[i].set({x:-250,y:250,invulnerable:300});
      }
      if (((((game.ships[i].x-50)*(game.ships[i].x-50))+((game.ships[i].y+50)*(game.ships[i].y+50))))<=100)
      {
        //area4
        if (area4===0)
        game.ships[i].set({x:250,y:-250,invulnerable:300,score:0});
      }
    }
  }
  if (game.step%30===0)
  {
    if (game.aliens.length===0)
    {
    game.addAlien({x:250,y:250,code:12,level:0,points:0,crystal_drop:0});
    //game.aliens[0].set({rate:1,regen:0,shield:1020,damage:84,laser_speed:205});
    }
    else
    {
      if (((((game.aliens[0].x-250)*(game.aliens[0].x-250))+((game.aliens[0].y-250)*(game.aliens[0].y-250))))>=10000)
      {
      game.aliens[0].set({kill:true});
      }
    }
  }
  if (game.step%10===0)
  {
    for (var j=0;j<game.ships.length;j++)
    {
      if (game.ships[j].crystals>719)
      {
        game.ships[j].set({crystals:719});
      }
    }
  }
};

this.event = function(event,game) {
  let ship = event.ship;
  let killer = event.killer;
  let ast = event.asteroid;
  switch (event.name){
    case "ui_component_clicked":
      var component = event.id ;
      if (component == "Regen")
      {
        Regen(ship);
      }
      if (component == "A_Speed")
      {
        A_Speed(ship);
      }
      if (component == "Return")
      {
        Return(ship);
      }
      break ;
    case "ship_spawned":
      echo("new spawn");
      ship.set({x:0,y:0,type:605, stats:88888888, crystals:720, shield: 1000});
      break ;
  }
} ;
